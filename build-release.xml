<?xml version="1.0"?>

<project name="ELKI" default="preliminary" basedir=".">
	<property name="RELEASE" value="0.1"/>
	
	<property name="release.overview" value="release_0_1.html"/>
	
	<property name="basepackage" value="de/lmu/ifi/dbs/elki/"/>
	
	<property name="ELKI" value="ELKI"/>
	
	<property name="ELKI_LONG" value="ELKI: Environment for DeveLoping KDD-Applications Supported by Index-Structures"/>
	
	<tstamp>
		<format property="now" pattern="yyyy-MM-dd_HHmm" />
	</tstamp>

	<condition property="windows.disk.prefix" value="P:">
		<or>
			<equals arg1="${user.name}" arg2="achtert" />
			<equals arg1="${user.name}" arg2="schumm" />
			<equals arg1="${user.name}" arg2="wanka" />
			<and>
				<or>
					<equals arg1="${user.name}" arg2="kroegerp" />
					<equals arg1="${user.name}" arg2="zimek" />
				</or>
				<equals arg1="${os.name}" arg2="Windows XP" />
			</and>
		</or>
	</condition>

	<condition property="windows.web.prefix" value="W:">
		<or>
			<equals arg1="${user.name}" arg2="achtert" />
			<equals arg1="${user.name}" arg2="schumm" />
			<equals arg1="${user.name}" arg2="wanka" />
			<and>
				<or>
					<equals arg1="${user.name}" arg2="kroegerp" />
					<equals arg1="${user.name}" arg2="zimek" />
				</or>
				<equals arg1="${os.name}" arg2="Windows XP" />
			</and>
		</or>
	</condition>
	
	<property name="deploy.srcdir" value="${windows.disk.prefix}/nfs/infdbs/WissProj/KDD-Framework/releases/${RELEASE}/${now}/input"/>
	
	<property name="deploy.basedir" value="${windows.disk.prefix}/nfs/infdbs/WissProj/KDD-Framework/releases/${RELEASE}/${now}/output"/>
	
	<property name="deploy.target" value="${windows.web.prefix}/nfs/www/Forschung/KDD/ELKI/release${RELEASE}"/>

	<property name="deploy.javadoc" value="${deploy.basedir}/doc"/>

	
	<target name="preliminary" depends="copy4release,compile,javadoc"/>
	
	<target name="copy4release" description="copies selected resources to current release directory">
		<copy todir="${deploy.srcdir}/src">
			<fileset dir="src">
				<!-- CoDeC requires classifier -->
				<exclude name="${basepackage}algorithm/CoDeC.*"/>
				<exclude name="${basepackage}algorithm/ICA.*"/>
				<exclude name="${basepackage}algorithm/classifier/**"/>
				<exclude name="${basepackage}algorithm/outlier/**"/>
				<exclude name="${basepackage}algorithm/clustering/biclustering/NaivePatternBased.*"/>
				<exclude name="${basepackage}algorithm/clustering/correlation/FractalDimensionTest.*"/>
				<exclude name="${basepackage}algorithm/clustering/correlation/KernelFourC.*"/>
				<exclude name="${basepackage}algorithm/clustering/correlation/SubspaceAggregation.*"/>
				<exclude name="${basepackage}algorithm/clustering/correlation/SubspaceEM.*"/>
				<exclude name="${basepackage}algorithm/clustering/hierarchical/**"/>
				<exclude name="${basepackage}algorithm/clustering/subspace/FIRES.*"/>
				<exclude name="${basepackage}algorithm/result/GeneralizedLOFResult.*"/>
				<exclude name="${basepackage}algorithm/result/ICAResult.*"/>
				<exclude name="${basepackage}algorithm/result/clustering/FractalDimensionTestResult.*"/>
				<exclude name="${basepackage}algorithm/result/clustering/HierarchicalFractalDimensionCluster.*"/>
				<exclude name="${basepackage}algorithm/result/outlier/LOFResult.*"/>
				<exclude name="${basepackage}converter/Arff2Txt.*"/>
				<exclude name="${basepackage}converter/ArffSparseInstanceToSparseBitVector.*"/>
				<exclude name="${basepackage}converter/Database2Arff.*"/>
				<exclude name="${basepackage}converter/Txt2Arff.*"/>
				<exclude name="${basepackage}data/synthetic/**"/>
				<exclude name="${basepackage}distance/distancefunction/FractalDimensionBasedDistanceFunction"/>
				<exclude name="${basepackage}evaluation/**"/>
				<exclude name="${basepackage}featureextraction/**"/>
				<exclude name="${basepackage}gui/**"/>
				<exclude name="${basepackage}math/analysis/**"/>
				<exclude name="${basepackage}parser/ArffFileParser.**"/>
				<exclude name="${basepackage}varianceanalysis/ica/**"/>				
				<exclude name="${basepackage}wrapper/**"/>
			</fileset>			
		</copy>
	</target>
	
	<target name="javadoc" depends="compile">
			<javadoc
				destdir="${deploy.javadoc}"
				access="protected"
				use="true"
				notree="false"
				nonavbar="false"
				noindex="false"
				splitindex="true"
				author="true"
				version="false"
				nodeprecatedlist="false"
				nodeprecated="false"
				link="http://java.sun.com/javase/6/docs/api/"
				overview="${deploy.srcdir}/src/${release.overview}"
				classpath="${deploy.srcdir}/bin"
				doctitle="ELKI"
				windowtitle="ELKI">
				<packageset dir="${deploy.srcdir}/src"/>
				<footer>
                   &lt;table style="font-size:xx-small;"&gt;			
	                 &lt;tr&gt;
	                   &lt;td align="left"&gt;
	                    Release
	                   &lt;/td&gt;
	                   &lt;td align="center"&gt;
	                    ${RELEASE}
	                   &lt;/td&gt;
					   &lt;td align="right"&gt;
	                    (${now})
	                   &lt;/td&gt;
	                 &lt;/tr&gt;
                   &lt;/table&gt;
	            </footer>
				<header>ELKI</header>
			</javadoc>
		    <!-- GRAPHIKEN -->
		</target>
	
	<target name="compile" depends="copy4release">
		<javac destdir="${deploy.srcdir}" deprecation="true" debug="true" optimize="true" source="1.6" debuglevel="">
			<compilerarg value="-Xlint:all"/>
			<classpath path="${deploy.srcdir}/src" />
			<exclude name="*.xml" />
			<exclude name="*.html" />
			<exclude name="*.jar" />
			<exclude name="*.xsd" />
			<exclude name="*.prp" />
			<src path="${deploy.srcdir}/src" />
		</javac>
		<copy file="${deploy.srcdir}/src/${basepackage}properties/KDDFramework.prp" tofile="${deploy.srcdir}/${basepackage}properties/KDDFramework.prp"/>
	</target>
	
	<target name="jar">
	</target>

</project>