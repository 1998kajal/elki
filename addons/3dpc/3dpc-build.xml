<project name="ELKI-3DPC" default="jar">
	<property name="elkiroot" location="../.." />
	<property name="3dpc" location="${elkiroot}/addons/3dpc" />
	<property name="elkisrc" location="${elkiroot}/src" />
	<property name="elkibuild" location="${elkiroot}/build" />
	<property name="src" location="${3dpc}/src/main/java" />
	<property name="resources" location="${3dpc}/src/main/resources" />
	<property name="build" location="${3dpc}/build" />
	<property name="dist" location="." />
	<property name="elki" value="de.lmu.ifi.dbs.elki" />
	<property name="title"
		value="3DPC Addon for ELKI: Environment for DeveLoping KDD-Applications Supported by Index-Structures" />
	<property name="url" value="http://elki.dbs.ifi.lmu.de/wiki/3DPC" />
	<property name="version" value="0.6.0~beta1" />

	<target name="init">
		<!-- Create the build directory structure used by compile -->
	</target>

	<target name="compile" depends="init">
		<!-- Compile the java code from ${src} into ${build} -->
		<javac srcdir="${src}" destdir="${build}" includes=""
			includeantruntime="false" deprecation="false" debug="true"
			debuglevel="lines,vars,source" optimize="true" source="1.7" target="1.7">
			<compilerarg value="-Xlint:all" />
			<classpath>
				<pathelement path="${src}" />
				<pathelement path="${elkiroot}/elki.jar" />
				<!-- YOU MAY NEED TO INSTALL THESE FOR BUILDING -->
				<pathelement path="${elkiroot}/lib/gluegen2-rt.jar" />
				<pathelement path="${elkiroot}/lib/jogl2.jar" />
			</classpath>
		</javac>
	</target>

	<target name="install" depends="init">
		<!-- Install resources. -->
		<copy todir="${build}">
			<fileset dir="${resources}">
				<include name="*.CMD" />
				<include name="*.txt" />
				<include name="META-INF/elki/*" />
			</fileset>
		</copy>
		<fixcrlf srcDir="${build}" includes="*.CMD" eol="dos" />
		<!-- Include source code: -->
		<mkdir dir="${build}/src" />
		<copy todir="${build}/src">
			<fileset dir="${3dpc}/src">
				<include name="**/*.java" />
				<include name="**/*.txt" />
				<include name="**/*build.xml" />
				<include name="**/META-INF/elki/*" />
			</fileset>
		</copy>
	</target>

	<target name="jar" depends="compile, install">
		<!-- build precompiled jar -->
		<jar jarfile="${dist}/3dpc.jar" basedir="${build}">
			<manifest>
				<attribute name="Built-By" value="${user.name}" />
				<attribute name="Implementation-Title" value="${title}" />
				<attribute name="Implementation-Version" value="${version}" />
				<attribute name="Implementation-URL" value="${url}" />
			</manifest>
		</jar>
	</target>

	<target name="clean">
		<delete dir="${build}" />
		<delete dir="${dist}/3dpc.jar" />
	</target>
</project>
